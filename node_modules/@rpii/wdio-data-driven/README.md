# @rpii/wdio-data-driven

Provides tool for emulating [data driven tests](https://en.wikipedia.org/wiki/Data-driven_testing) in [webdriverio](http://webdriver.io/).
Updated for compatibility with webdriverio version 6. Now hides passwords.

Completely taken from the nightwatch version: https://github.com/rpii/nightwatch-data-driven and adapted for wdio.
Supports iteration of data from spreadsheet pages.
There are two modes of operation,  straight iteration or usage of callbacks functions for asserting on varying conditions.
Works with sync mode.  Allows the usage of spreadsheets pages as datasets for test iteration.

#### Installation

```sh
npm i @rpii/wdio-data-driven --save
```

#### Example 1: Simple usage

1. Create DataDrivenTest instance passing a **function representing the body of the test** 
(the **A**rrange

    **T**estFn
    
    **A**ssert_ functions).
    
2. Call **forCases** method with object containing *names* and *data* for test cases. Use **disabled** parameter to deactivate test case(see example).
3. Pass in a spreadsheet with the credentials to be tested.

```js
import DataDrivenTest from '@rpii/wdio-data-driven';
import {authConfig}  from '../configs/auth';


suite('login test suite', function () {
    test('user login missing password', function () {

        new DataDrivenTest(browser, function(dataSet, name) {
            LoginPage.loginFn(dataSet,LoginPage.assertInvalidCredentials.bind(LoginPage));
        })
        .forCasesInSpreadsheet('./test/data/credentials.xlsx', 'bad-credentials');

    });
};

```

#### Example 2: Building and reusing of "test blanks"
1. Create DataDrivenTest instance without parameters for our "test blank".
2. Call **withArrange** method passing **A**rrange function of "test blank".
3. Call **testFn** method passing **Action** function of "test blank".
4. Call **withAssert** defining the assert for this case.
5. Now you can reuse "test blank" calling **withAssert** and **forCases** methods with different _**A**ssert_ functions and data in each particular test.


```js
import DataDrivenTest from '@rpii/wdio-data-driven';
import {mother} from '../mother';

// . Create "test blank"
let submitLoginForm = new DataDrivenTest()
	.testFn(function(dt) {
		this.browser.page.login().section.loginForm.fillAndSubmit(dt.email, dt.pass)
	})
	.withArrange(function(cb) {
		browser.logout(cb)
	});
	
suite('invalid email test suite', function () {
    test('Login is invalid email: show error': function () {
        // . Use "test blank" with specific assertion and test cases
        submitLoginForm
            .withAssert((dt, nm) => browser.page.login().assertNoProgress(nm))
            .forCases({
                "1. ": {email: "a", pass: mother.Valid.PASS},
                "2. ": {email: "@b", pass: mother.Valid.PASS},
                "3. ": {email: "@b.", pass: mother.Valid.PASS},
                "4. ": {email: "@b.c", pass: mother.Valid.PASS},
                "5. ": {email: "a@b", pass: mother.Valid.PASS},
                "6. ": {email: "a@b.", pass: mother.Valid.PASS},
                "7. ": {email: "a@b.c", pass: mother.Valid.PASS},
                "8. ": {email: "й@ц.ук", pass: mother.Valid.PASS},
            });
        });
    
    test('Login is valid email: show progress': function () {
        // . Use "test blank" with specific assertion and test cases
        submitLoginForm
            .withAssert((dt, nm) => browser.page.login().assertProgressDisplayed(nm))
            .forCases({
                "1. ": {email: "a@b.cd"},
                "2. ": {email: "1#$%&'*+/=?^-_`{|}~.a@b.cd"},
                "3. ": {email: "a@1-b.cd"},
                "4. ": {email: "a@b.12"}
            });
        });
    }

```
